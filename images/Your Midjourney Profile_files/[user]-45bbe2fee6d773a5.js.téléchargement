(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{51367:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/users/[user]",function(){return n(90853)}])},90853:function(e,t,n){"use strict";n.r(t);var r=n(34051),o=n.n(r),s=n(85893),a=(n(83454),n(67294)),i=n(67471),l=n(96857),c=n(44681),u=n(40169),d=n(56365),f=n(91962),p=n(59700),h=n(38945),m=n(1848),x=n(8639),v=n(20640),g=n.n(v),b=n(41664),j=n(11163),w=n(44012),y=n(86896),N=n(1852),k=n(88305),Z=n(68697),_=n(60204),C=n(36090),O=n(60670),S=n(743),E=n(38121),A=n(50073),D=n(2213),M=n(70206),I=n(40031),L=n(73149),q=n(45591),B=n(4154),F=n(95611),P=n(66320),U=n(27461),T=n(45332),W=n(27226),R=n(22379);function V(e,t,n,r,o,s,a){try{var i=e[s](a),l=i.value}catch(c){return void n(c)}i.done?t(l):Promise.resolve(l).then(r,o)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function a(e){V(s,r,o,a,i,"next",e)}function i(e){V(s,r,o,a,i,"throw",e)}a(void 0)}))}}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){H(e,t,n[t])}))}return e}var J=function(e){var t,n,r,v,Z=e.id,V=e.username,H=e.userData,J=(e.otherUsers,(0,k.u)(q.w).useListOfJobs),X=(0,k.u)(B.V),G=X.setModalState,K=(X.setQuery,X.query),Y=X.setQueryVal,$=X.setTempQuery,ee=X.fullWidth,te=(0,L.aC)(),ne=te.userInfo,re=te.modCheck,oe=(0,F.Z)(H),se=oe.handleFollow,ae=oe.followed,ie=(0,j.useRouter)(),le=(0,N.useMediaQuery)({maxWidth:768}),ce=(0,a.useState)(!0),ue=ce[0],de=ce[1],fe=J({defaultSort:"hot",initialSettings:Q({jobStatus:"completed",userId:Z,search:"advanced"},Z===(null===ne||void 0===ne?void 0:ne.id)?{isPublished:"true"}:{},{orderBy:(null===(t=ie.query)||void 0===t?void 0:t.sort)||"hot",minRankingScore:"0"})});(0,a.useEffect)((function(){var e,t,n;(null===(e=ie.query)||void 0===e||null===(t=e.search)||void 0===t?void 0:t.length)>0&&(fe.settings.prompt=(null===(n=ie.query)||void 0===n?void 0:n.search)||null);return setTimeout((function(){return fe.firstLoad()}),1),function(){Y(""),$("")}}),[]),(0,a.useEffect)((function(){fe.jobsList.length>0&&G((function(e){return Q({},e,{jobDataArray:fe.jobsList,jobDataArrayCache:fe.jobsList})}))}),[fe.jobsList,G]),(0,a.useEffect)((function(){fe.isFirstRun||fe.settings.prompt===K&&!!fe.settings.prompt===!!K||(K&&(fe.settings.prompt=K),fe.search())}),[fe.isFirstRun,fe.settings.prompt,K]);var pe=(0,a.useState)(!1),he=pe[0],me=pe[1],xe=(0,a.useMemo)((function(){return[le&&{title:"View archive",link:"/app/users/".concat(Z,"/archive"),icon:(0,s.jsx)(i.Z,{height:18})},le&&{title:ae?"Unfollow":"Follow",warn:ae,onClick:se,icon:ae?(0,s.jsx)(l.Z,{height:"16",className:""}):(0,s.jsx)(c.Z,{height:"16",className:""}),slug:"follow"},le&&re("moderator")&&{title:"break-9"},re("moderator")&&{title:"Mod Actions",disabled:!0,icon:(0,s.jsx)(u.Z,{height:"16",className:""}),optionArray:[{title:"Open in Mod Panel",link:"/mods/users/".concat(Z,"/archive"),icon:(0,s.jsx)(d.Z,{height:"16"}),slug:"open-mod-panel"},{title:"Copy Discord ID",onClick:function(){return(0,E.Dq)(Z)},icon:(0,s.jsx)(S.O5,{height:"16"}),slug:"copy-userid"},{title:"Copy ID",onClick:function(){return g()(Z)},icon:(0,s.jsx)(f.Z,{height:"16"}),slug:"copy-userid"},{title:"Contact",onClick:function(){var e=prompt("What is your message for ".concat(V,"?")),t=confirm("Do you want to clear their queue and force a response? OK for yes, Cancel for no.");e&&fetch("/api/app/users/mod-contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:Z,message:e.trim(),resetCooldowns:t})}).then(function(){var e=z(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:!(null===(n=e.sent)||void 0===n?void 0:n.error)&&t.ok?(0,W.z5)("Message sent!"):(0,W.x8)("Message failed to send: ".concat(t.status," ").concat((null===n||void 0===n?void 0:n.error)||t.statusText," (").concat(n.trace,")"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){(0,W.x8)("Error sending message: ".concat(e))}))},icon:(0,s.jsx)(p.Z,{height:"16",className:""})},re("community")&&{title:"Wipe User",danger:!0,onClick:function(){confirm("Are you sure you want to wipe all jobs for ".concat(V,"?"))&&confirm("Absolutely, 100% super-duper sure you want to wipe all jobs for ".concat(V,"?"))&&fetch("/api/mod/wipe-user",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:Z})}).then((function(e){200===e.status?(0,W.z5)("User wiped! Reload the page to see changes."):(0,W.x8)("Something went wrong: : ".concat(e.status," ").concat(e.statusText))})).catch((function(e){(0,W.x8)("Something went wrong: ".concat(e))}))},icon:(0,s.jsx)(h.Z,{height:"16",className:""})}].filter(Boolean)}].filter(Boolean)}),[ae,se,Z,le,re,V]),ve=(0,a.useMemo)((function(){return(0,s.jsxs)(s.Fragment,{children:[!le&&(0,s.jsxs)(O.Z,{href:"/app/users/".concat(Z,"/archive"),className:"group min-w-max max-w-max !font-bold !px-6 text-darkBlue-500 rounded-full .border-2 bg-slate-300 hover:!bg-slate-200 flex gap-2 items-center justify-center !bg-opacity-100",children:[(0,s.jsx)(i.Z,{height:18})," ",(0,s.jsx)("span",{className:"hidden md:inline",children:(0,s.jsx)(w.Z,{id:"nav.archive"})})]},"archive"),!le&&(0,s.jsx)(C.Z,{onClick:function(){me(!0),se()},onMouseLeave:function(){return me(!1)},className:"group-button min-w-max max-w-max !font-bold !px-6 text-darkBlue-500 rounded-full .border-2 bg-slate-300  flex gap-2 items-center justify-center !bg-opacity-100 ".concat(ae&&!he?" hover:border-red-700 hover:text-red-200 hover:!bg-red-900 ":"hover:!bg-slate-200"),children:ae?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:he?"flex":"flex [.group-button:hover_&]:hidden",children:"Following"}),(0,s.jsx)("span",{className:he?"hidden":"hidden [.group-button:hover_&]:flex relative before:text-transparent before:content-['Following']",children:(0,s.jsx)("span",{className:"absolute centerAbs",children:"Unfollow"})})]}):(0,s.jsx)("span",{className:"flex relative before:text-transparent before:content-['Following']",children:(0,s.jsxs)("span",{className:"flex absolute justify-center items-center centerAbs",children:[(0,s.jsx)(c.Z,{height:18,className:"mr-2 inline"}),(0,s.jsx)(w.Z,{id:"app.follow"})]})})},"followButton"),le||re("moderator")&&(0,s.jsx)(D.Z,{optionArray:xe,maxWidth:"!w-max",placement:"top-end",className:"h-full",offset:[0,10],transformOrigin:"top-right",buttonHoverStyle:"!rounded-full",children:(0,s.jsx)(C.Z,{className:(0,T.CN)("group aspect-square md:text-darkBlue-500 rounded-full .border-2 bg-slate-100/5  md:bg-slate-300 md:hover:!bg-slate-200 flex gap-2 items-center justify-center !bg-opacity-100"),children:(0,s.jsx)(m.Z,{height:le?18:24})},"options")})]})}),[xe,he,ae,se,Z,le,re]),ge=(0,a.useMemo)((function(){var e;return(null===H||void 0===H?void 0:H.created)?"".concat(null===(e=(0,T.L0)(new Date(null===H||void 0===H?void 0:H.created),!0)[1])||void 0===e?void 0:e.replace(" 2022","").replace(",","")):"Unknown"}),[null===H||void 0===H?void 0:H.created]),be=(0,y.Z)();return(0,s.jsxs)(U.o,{title:V||"User",fullWidth:ee,className:T.VU,icon:(0,s.jsx)(R.Avatar,{user:Z,avatar:null===H||void 0===H?void 0:H.avatar_job_id,size:32}),meta:(0,s.jsx)(P.h,{title:be.formatMessage({id:"app.usersGallery"},{user:V}),description:be.formatMessage({id:"app.allTheImages"},{id:Z})}),children:[(0,s.jsx)(R.UserBanner,{bannerUrl:"https://mj-gallery.com/".concat((null===H||void 0===H?void 0:H.cover_job_id)||(null===(n=fe.jobsList)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.state.id),"/grid_0.webp"),username:V,children:(0,s.jsx)(R.UserBannerInfo,{avatar:H.avatar_job_id,tagline:(0,s.jsx)("p",{children:(0,s.jsxs)("span",{className:"text-slate-500",children:[(0,s.jsx)(w.Z,{id:"app.userSince"})," ",ge]})}),user:H,username:V,customButtons:ve})}),ue&&(0,s.jsxs)("div",{className:"flex relative flex-col gap-4 md:px-4 mt-4 md:mt-2 mb-6 w-full xl:my-6",children:[(0,s.jsxs)("div",{className:"flex justify-between px-2 -mb-3 w-full text-base",children:[(0,s.jsx)("p",{className:"font-medium text-slate-400"}),(0,s.jsx)(b.default,{href:"/app/users/".concat(Z,"/collections"),children:(0,s.jsxs)("a",{href:"",className:"text-slate-500 hover:text-slate-300",children:[(0,s.jsx)(w.Z,{id:"app.viewAllCollections"})," ",(0,s.jsx)(x.Z,{height:18,className:"inline -rotate-45"})]})})]}),(0,s.jsx)(_.Z,{userId:Z,home:!0,hideCallback:function(){return de(!1)},className:"overflow-x-scroll gap-4 py-2 w-full miniScrollbar",buttonClassName:"md:basis-1 max-w-[50%] md:max-w-[33%]",showAddButton:!1,maxItems:4,publicDisplay:!0})]}),(0,s.jsx)(M.x,{fixedData:fe,params:{showService:!0}}),(0,s.jsx)(I.H,{query:null===(v=ie.query)||void 0===v?void 0:v.jobId,returnHref:"/app/users/".concat(Z)}),(0,s.jsx)(A.Z,{fixedData:fe,settings:{dedupe:!1}})]})};J.getInitialProps=function(){var e=z(o().mark((function e(t){var n,r,s,a,i,l,c,u,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.query.user,(0,Z.Z)(a)){e.next=11;break}return e.next=5,(0,T.EE)("".concat("https://www.midjourney.com","/api/auth/get-user/?discord_id=").concat(a));case 5:if(null===(i=e.sent)||void 0===i?void 0:i.user_id){e.next=9;break}return(0,T.FA)(t,"/404"),e.abrupt("return",{});case 9:return(0,T.FA)(t,"/app/users/".concat(i.user_id)),e.abrupt("return",{});case 11:return e.next=13,fetch("".concat("https://www.midjourney.com","/api/app/users/?userIds=").concat(t.query.user),{headers:{Cookie:null===(n=t.req)||void 0===n?void 0:n.headers.cookie}});case 13:return l=e.sent,e.next=16,l.json();case 16:return c=e.sent,u=[null===(r=c[0])||void 0===r?void 0:r.user_id,null===(s=c[0])||void 0===s?void 0:s.username],f=u[1],(d=u[0])&&f||(0,T.FA)(t,"/404"),e.abrupt("return",{id:d,username:f,userData:c[0],otherUsers:c});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.default=J},59700:function(e,t,n){"use strict";var r=n(67294);const o=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}))}));t.Z=o}},function(e){e.O(0,[9774,2888,179],(function(){return t=51367,e(e.s=t);var t}));var t=e.O();_N_E=t}]);